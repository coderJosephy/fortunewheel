<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Fortune Wheel</title>
<style>
  body { font-family: sans-serif; background:#222; color:#fff; text-align:center; padding-top:40px; }
  #wheel-container { position: relative; margin: 20px auto; width: 320px; height: 320px; }
  #pointer { position:absolute; top:-30px; left:50%; transform:translateX(-50%); font-size:2.6em; z-index:10; }
  #spinBtn { margin-top:10px; padding:12px 32px; font-size:1.2em; cursor:pointer; border:none; border-radius:8px; background:#FFD700; color:#333; font-weight:bold; }
  #money { margin-top:12px; font-size:1.2em; font-weight:bold; color:#0f0; }
  #result { margin-top:16px; font-size:1.4em; font-weight:bold; min-height:2em; }
</style>
</head>
<body>
<h1>ğŸ° Fortune Wheel</h1>
<div id="wheel-container">
  <div id="pointer">ğŸ”»</div>
  <canvas id="wheel" width="320" height="320"></canvas>
</div>
<div id="money">Money: $1000</div>
<button id="spinBtn">Spin! (-$100)</button>
<div id="result"></div>

<script>
document.addEventListener("DOMContentLoaded", () => {
  const slices = [
    { emoji: "ğŸ’°", label: "Super Jackpot", reward: 2000 },
    { emoji: "ğŸ§§", label: "Jackpot", reward: 1000 },
    { emoji: "ğŸ€", label: "Lucky", reward: 80 },
    { emoji: "ğŸ˜ƒ", label: "Smile", reward: 50 },
    { emoji: "ğŸ§", label: "Treat", reward: 30 },
    { emoji: "ğŸ‰", label: "Party", reward: 120 },
    { emoji: "ğŸ”®", label: "Mystery", reward: 60 },
    { emoji: "ğŸŒˆ", label: "Rainbow", reward: 150 },
    { emoji: "ğŸ’", label: "Gem", reward: 300 }
  ];

  const colors = ["#FF6384","#36A2EB","#FFCE56","#4BC0C0","#9966FF","#FF9F40","#50C878","#E2E2E2","#FF69B4"];
  const weights = [0.01,0.03,0.15,0.15,0.10,0.20,0.15,0.11,0.10];

  const canvas = document.getElementById("wheel");
  const ctx = canvas.getContext("2d");
  const spinBtn = document.getElementById("spinBtn");
  const moneyDiv = document.getElementById("money");
  const resultDiv = document.getElementById("result");

  let money = 1000;
  let wheelRotation = 0;
  let spinning = false;
  const spinCost = 100;

  function weightedRandom(weights){
    let r = Math.random();
    let sum = 0;
    for(let i=0;i<weights.length;i++){
      sum += weights[i];
      if(r<=sum) return i;
    }
    return weights.length-1;
  }

  function drawWheel(rotation=0){
    const radius = canvas.width/2;
    const cx = radius;
    const cy = radius;
    const sliceAngle = 2*Math.PI/slices.length;
    ctx.clearRect(0,0,canvas.width,canvas.height);

    for(let i=0;i<slices.length;i++){
      const angle = rotation + i*sliceAngle;
      ctx.beginPath();
      ctx.moveTo(cx,cy);
      ctx.arc(cx,cy,radius,angle,angle+sliceAngle,false);
      ctx.closePath();
      ctx.fillStyle = colors[i % colors.length];
      ctx.fill();

      ctx.save();
      ctx.translate(cx,cy);
      ctx.rotate(angle + sliceAngle/2);
      ctx.textAlign="center";
      ctx.textBaseline="middle";
      ctx.font="28px serif";
      ctx.fillStyle="#000";
      ctx.fillText(slices[i].emoji, radius*0.55, -10);
      ctx.font="bold 14px sans-serif";
      ctx.fillText(slices[i].label, radius*0.55, 20);
      ctx.restore();
    }

    // Draw center circle
    ctx.beginPath();
    ctx.arc(cx, cy, 40, 0, 2*Math.PI);
    ctx.fillStyle="#FFD700";
    ctx.fill();
    ctx.strokeStyle="#B09700";
    ctx.lineWidth=4;
    ctx.stroke();
    ctx.fillStyle="#333";
    ctx.font="24px serif";
    ctx.fillText("ğŸ¯", cx, cy);
  }

  drawWheel();

  spinBtn.onclick = ()=>{
    if(spinning) return;
    if(money<spinCost){
      resultDiv.textContent="Not enough money!";
      return;
    }
    spinning=true;
    money-=spinCost;
    moneyDiv.textContent=`Money: $${money}`;
    resultDiv.textContent="";

    const sliceAngle=2*Math.PI/slices.length;
    const pickedIndex=weightedRandom(weights);
    const stopAngle=(3*Math.PI/2)-(pickedIndex*sliceAngle)-(sliceAngle/2);
    const extraSpins=4;
    const finalRotation=(2*Math.PI*extraSpins)+stopAngle;
    const duration=3000;
    const startRotation=wheelRotation;
    const start=performance.now();

    function animate(ts){
      let elapsed = ts-start;
      let progress = Math.min(elapsed/duration,1);
      let eased = 1 - Math.pow(1-progress,3);
      wheelRotation=startRotation + eased*(finalRotation-startRotation);
      drawWheel(wheelRotation);
      if(progress<1){
        requestAnimationFrame(animate);
      }else{
        spinning=false;
        wheelRotation=finalRotation%(2*Math.PI);
        drawWheel(wheelRotation);
        const prize = slices[pickedIndex];
        money+=prize.reward;
        moneyDiv.textContent=`Money: $${money}`;
        resultDiv.textContent=`You got ${prize.emoji} ${prize.label} and won $${prize.reward}!`;
      }
    }

    requestAnimationFrame(animate);
  };
});
</script>
</body>
</html>
