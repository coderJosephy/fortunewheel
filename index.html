<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>Fortune Wheel Emoji Game</title>
<style>
body {
  font-family: sans-serif;
  background: #222;
  color: #fff;
  display: flex;
  flex-direction: column;
  align-items: center;
  min-height: 100vh;
  margin: 0;
  padding-top: 40px;
}
h1 { margin-bottom: 10px; }
#wheel-container { position: relative; width: 360px; height: 360px; margin: 20px 0; }
#wheel {
  width: 100%;
  height: 100%;
  border-radius: 50%;
  background: #333;
  box-shadow: 0 0 20px #000;
  position: absolute;
  top: 0;
  left: 0;
}
#pointer {
  position: absolute;
  top: -30px;
  left: 50%;
  transform: translateX(-50%);
  font-size: 2.4em;
  z-index: 10;
  pointer-events: none;
  text-shadow: 0 2px 8px #000;
}
#spinBtn {
  background: #FFD700;
  color: #333;
  border: none;
  border-radius: 8px;
  padding: 12px 32px;
  font-size: 1.2em;
  cursor: pointer;
  font-weight: bold;
  margin-top: 10px;
  margin-bottom: 12px;
  box-shadow: 0 4px 12px #2228;
  transition: background 0.2s;
}
#spinBtn:active { background: #e6c200; }
#money { font-size: 1.2em; margin-bottom: 12px; font-weight: bold; color: #0f0; }
#result { margin-top: 16px; font-size: 1.4em; font-weight: bold; min-height: 2em; }
</style>
</head>
<body>
<h1>🎰 Fortune Wheel</h1>
<div id="wheel-container">
  <div id="pointer">🔻</div>
  <canvas id="wheel" width="360" height="360"></canvas>
</div>
<div id="money">Money: $1000</div>
<button id="spinBtn">Spin! (-$100)</button>
<div id="result"></div>

<script>
const slices = [
  { emoji: "💰", label: "Super Jackpot", reward: 1000 },
  { emoji: "🧧", label: "Jackpot", reward: 500 },
  { emoji: "🍀", label: "Lucky", reward: 150 },
  { emoji: "😃", label: "Smile", reward: 65 },
  { emoji: "🧁", label: "Treat", reward: 50 },
  { emoji: "🎉", label: "Party", reward: 250 },
  { emoji: "🔮", label: "Mystery", reward: 75 },
  { emoji: "🌈", label: "Rainbow", reward: 250 },
  { emoji: "💎", label: "Gem", reward: 350 }
];

const colors = ["#FF6384","#36A2EB","#FFCE56","#4BC0C0",
                "#9966FF","#FF9F40","#50C878","#E2E2E2","#FF69B4"];

const weights = [0.01,0.03,0.16,0.16,0.12,0.16,0.12,0.12,0.12];

const canvas = document.getElementById('wheel');
const ctx = canvas.getContext('2d');
const spinBtn = document.getElementById('spinBtn');
const resultDiv = document.getElementById('result');
const moneyDiv = document.getElementById('money');

let spinning = false;
let wheelRotation = Math.random() * Math.PI*2; // random start angle
let money = 1000;
const spinCost = 100;

function weightedRandom(weights){
  let r = Math.random();
  let sum = 0;
  for(let i=0;i<weights.length;i++){
    sum+=weights[i];
    if(r<=sum) return i;
  }
  return weights.length-1;
}

function drawWheel(rotation=0){
  const radius = canvas.width/2;
  const cx = radius;
  const cy = radius;
  const sliceAngle = 2*Math.PI/slices.length;
  ctx.clearRect(0,0,canvas.width,canvas.height);

  for(let i=0;i<slices.length;i++){
    const start = rotation + i*sliceAngle;
    const end = start + sliceAngle;
    const mid = (start+end)/2;

    ctx.beginPath();
    ctx.moveTo(cx,cy);
    ctx.arc(cx,cy,radius,start,end,false);
    ctx.closePath();
    ctx.fillStyle = colors[i%colors.length];
    ctx.fill();

    // emoji + text aligned with slice mid line
    const textRadius = radius * 0.62;
    ctx.save();
    ctx.translate(cx, cy);
    ctx.rotate(mid);

    ctx.textAlign = "center";
    ctx.textBaseline = "middle";

    ctx.font = `${radius * 0.18}px serif`;
    ctx.fillStyle = "#000";
    ctx.fillText(slices[i].emoji, textRadius, -8);

    ctx.font = `bold ${radius * 0.09}px sans-serif`;
    ctx.fillStyle = "#222";
    ctx.fillText(slices[i].label, textRadius, 18);

    ctx.restore();
  }

  // center hub + 🎯 perfectly aligned
  ctx.beginPath();
  ctx.arc(cx, cy, 36, 0, 2*Math.PI); // slightly smaller, exact center
  ctx.fillStyle = "#FFD700";
  ctx.fill();
  ctx.strokeStyle = "#B09700";
  ctx.lineWidth = 4;
  ctx.stroke();

  ctx.font = "1.8em serif";
  ctx.fillStyle = "#333";
  ctx.textAlign = "center";
  ctx.textBaseline = "middle";
  ctx.fillText("🎯", cx, cy);
}

drawWheel(wheelRotation);

spinBtn.onclick = function(){
  if(spinning) return;
  if(money<spinCost){
    resultDiv.textContent="Not enough money!";
    return;
  }
  spinning=true;
  money-=spinCost;
  moneyDiv.textContent=`Money: $${money}`;
  resultDiv.textContent="";

  const sliceAngle = 2*Math.PI/slices.length;
  const pickedIndex = weightedRandom(weights);
  const stopAngle = (3*Math.PI/2) - (pickedIndex*sliceAngle) - (sliceAngle/2);

  const extraSpins = 4;
  const finalRotation = wheelRotation + (2*Math.PI*extraSpins) + stopAngle - (wheelRotation % (2*Math.PI));

  let start=null;
  const duration=3000;
  const initialRotation = wheelRotation;

  function animateWheel(ts){
    if(!start) start=ts;
    const elapsed = ts-start;
    const progress = Math.min(elapsed/duration,1);
    const eased = 1-Math.pow(1-progress,3);
    wheelRotation = initialRotation + eased*(finalRotation-initialRotation);
    drawWheel(wheelRotation);
    if(progress<1) requestAnimationFrame(animateWheel);
    else{
      spinning=false;
      wheelRotation = wheelRotation % (2*Math.PI);
      drawWheel(wheelRotation);
      const prize = slices[pickedIndex];
      money += prize.reward;
      moneyDiv.textContent=`Money: $${money}`;
      resultDiv.textContent=`You won ${prize.emoji} ${prize.label}! (+$${prize.reward})`;
    }
  }
  requestAnimationFrame(animateWheel);
};
</script>
</body>
</html>
